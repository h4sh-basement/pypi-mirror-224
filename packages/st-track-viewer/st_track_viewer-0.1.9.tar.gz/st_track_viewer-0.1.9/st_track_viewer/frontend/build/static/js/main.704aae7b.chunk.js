(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{477:function(e,t,n){},478:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=478},731:function(e,t,n){},733:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(58),s=n.n(r),c=n(131),o=n(25),l=n(11),d=n(430),u=n(832),h=n(839),j=function(e){return e.UNKNOWN="Unknown",e.BICYCLE="Bicycle",e.PEDESTRIAN="Pedestrian",e.LIGHT_VEHICLE="Light vehicle",e.HEAVY_VEHICLE="Heavy vehicle",e}({}),b=Object.values(j);function f(e){return b.includes(e)}function m(e){switch(e){case j.UNKNOWN:return"green";case j.BICYCLE:return"purple";case j.PEDESTRIAN:return"red";case j.LIGHT_VEHICLE:return"cyan";case j.HEAVY_VEHICLE:return"pink"}}var g=200,p=150,O=n(35),x=n.n(O),v=n(192),y=n(37),k=n(48),w=n(13),T=n(7),C=n(8),S=n(4),L=n(5),M=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(S.a)(this,e),this._pos=void 0,this._pos=[t,n,a]}return Object(L.a)(e,[{key:"x",get:function(){return this._pos[0]},set:function(e){this._pos[0]=e}},{key:"y",get:function(){return this._pos[1]},set:function(e){this._pos[1]=e}},{key:"z",get:function(){return this._pos[2]},set:function(e){this._pos[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}},{key:"distanceTo",value:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2)+Math.pow(e.z-this.z,2))}}],[{key:"cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x)}}]),e}(),N=function(e){Object(T.a)(n,e);var t=Object(C.a)(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return Object(S.a)(this,n),(e=t.call(this,a,i,r))._angles=void 0,e._angles=[s,c,o],e}return Object(L.a)(n,[{key:"yaw",get:function(){return this._angles[0]},set:function(e){this._angles[0]=e}},{key:"pitch",get:function(){return this._angles[1]},set:function(e){this._angles[1]=e}},{key:"roll",get:function(){return this._angles[2]},set:function(e){this._angles[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.yaw===e.yaw&&this.pitch===e.pitch&&this.roll===e.roll}}]),n}(M);n(477);function I(){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return e[0][0]=1,e[1][1]=1,e[2][2]=1,e[3][3]=1,e}function F(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],a=0;a<4;a++)for(var i=0;i<4;i++)n[a][i]=e[a][0]*t[0][i]+e[a][1]*t[1][i]+e[a][2]*t[2][i]+e[a][3]*t[3][i];return n}function E(e,t){var n=new M;return n.x=e[0][0]*t.x+e[0][1]*t.y+e[0][2]*t.z+e[0][3],n.y=e[1][0]*t.x+e[1][1]*t.y+e[1][2]*t.z+e[1][3],n.z=e[2][0]*t.x+e[2][1]*t.y+e[2][2]*t.z+e[2][3],n}function W(e,t){var n=Math.cos(t),a=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=1,i[1][1]=n,i[1][2]=-a,i[2][1]=a,i[2][2]=n,i[3][3]=1,F(i,e)}function R(e,t){var n=Math.cos(t),a=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=n,i[0][2]=a,i[1][1]=1,i[2][0]=-a,i[2][2]=n,i[3][3]=1,F(i,e)}function H(e,t){var n=Math.cos(t),a=Math.sin(t),i=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return i[0][0]=n,i[0][1]=-a,i[1][0]=a,i[1][1]=n,i[2][2]=1,i[3][3]=1,F(i,e)}function z(e,t,n,a){return e=W(e=R(e=H(e,t),n),a)}function D(e,t,n,a){var i=JSON.parse(JSON.stringify(e));return i[0][0]+=e[3][0]*t,i[0][1]+=e[3][1]*t,i[0][2]+=e[3][2]*t,i[0][3]+=e[3][3]*t,i[1][0]+=e[3][0]*n,i[1][1]+=e[3][1]*n,i[1][2]+=e[3][2]*n,i[1][3]+=e[3][3]*n,i[2][0]+=e[3][0]*a,i[2][1]+=e[3][1]*a,i[2][2]+=e[3][2]*a,i[2][3]+=e[3][3]*a,i}function _(e,t,n,a){var i=JSON.parse(JSON.stringify(e));return i[0][0]*=t,i[0][1]*=t,i[0][2]*=t,i[0][3]*=t,i[1][0]*=n,i[1][1]*=n,i[1][2]*=n,i[1][3]*=n,i[2][0]*=a,i[2][1]*=a,i[2][2]*=a,i[2][3]*=a,i}function P(e,t,n,a){return[(a=E(V(e,t,n),a)).x,a.y]}function V(e,t,n){var a=I();return a=D(a,-e.pos.x,-e.pos.y,-e.pos.z),a=D(a=_(a=z(a,-e.pos.yaw,-e.pos.pitch,-e.pos.roll),t/e.width,n/e.height,1),.5*t-.5,.5*n-.5,0)}var B=n(1),A=function(e){var t=e.WIDTH,n=e.HEIGHT,i=e.scale,r=e.tracks,s=e.ground,c=e.showId,o=e.filters;return Object(B.jsx)("svg",{width:t,height:n,style:{transform:"scale(".concat(i,")"),transformOrigin:"top left",overflow:"visible"},children:Object(a.useMemo)((function(){return r.map((function(e){var a=e.pathString(s,t,n,o.onlyConfirmed,o.markMeasurements,o.markEstimated),i=P(s,t,n,e.startPos),r=Object(l.a)(i,2),d=r[0],u=r[1],h=P(s,t,n,e.endPos),j=Object(l.a)(h,2),b=j[0],f=j[1];return Object(B.jsxs)("g",{children:[a.map((function(e,t){var n=Object(l.a)(e,2),a=n[0],i=n[1];return Object(B.jsx)("path",{d:a,stroke:i,fill:"none"},t)})),Object(B.jsx)("circle",{cx:d,cy:u,r:4,fill:"green",strokeWidth:"4"}),Object(B.jsx)("circle",{cx:b,cy:f,r:4,fill:"red",strokeWidth:"4"}),c&&Object(B.jsx)("text",{x:b,y:f,fill:"white",fontFamily:"sans-serif",fontSize:10,children:e.id})]},e.id)}))}),[r,s,c,n,t,o])})},K=n(404),Y=n.n(K),G=n(828),U=n(223),J=n(844),q=n(845),X=n(829),Q=n(834),Z=function(e){var t=e.filters,n=e.onMarkMeasurements,a=e.onMarkEstimated,i=e.onMarkOnlyConfirmed,r=e.onMarkTrackId;return Object(B.jsx)(J.a,{sx:{margin:0,marginLeft:2},component:"fieldset",variant:"standard",children:Object(B.jsxs)(q.a,{row:!0,children:[Object(B.jsxs)(q.a,{children:[Object(B.jsx)(X.a,{control:Object(B.jsx)(Q.a,{checked:t.markMeasurements,onChange:n}),label:Object(B.jsx)(U.a,{fontSize:15,fontWeight:600,children:"Mark measurements"})}),Object(B.jsx)(X.a,{control:Object(B.jsx)(Q.a,{checked:t.markEstimated,onChange:a}),label:Object(B.jsx)(U.a,{fontSize:15,fontWeight:600,children:"Mark estimated"})})]}),Object(B.jsxs)(q.a,{children:[Object(B.jsx)(X.a,{control:Object(B.jsx)(Q.a,{checked:t.onlyConfirmed,onChange:i}),label:Object(B.jsx)(U.a,{fontSize:15,fontWeight:600,children:"Show only confirmed"})}),Object(B.jsx)(X.a,{control:Object(B.jsx)(Q.a,{checked:t.trackId,onChange:r}),label:Object(B.jsx)(U.a,{fontSize:15,fontWeight:600,children:"Show track id"})})]})]})})},$=n(846),ee=n(847),te=n(837),ne=n(826),ae=n(851),ie=n(813),re=function(){function e(t,n,a,i,r,s){Object(S.a)(this,e),this.id=void 0,this.startTime=void 0,this.endTime=void 0,this.timestamps=void 0,this.coordinates=void 0,this.speeds=void 0,this.estimated=void 0,this.types=void 0,this.presentTypes=void 0,this.startPos=void 0,this.endPos=void 0,this.id=t,this.timestamps=n,this.startTime=x()(n[0]),this.endTime=x()(n.at(-1)),this.coordinates=a[0].map((function(e,t){return new M(e,a[1][t],0)})),this.speeds=i,this.estimated=r.map((function(e){return 1===e})),this.types=s.map((function(e){return function(e){switch(e){case 0:default:return j.UNKNOWN;case 1:return j.BICYCLE;case 4:return j.PEDESTRIAN;case 18:return j.LIGHT_VEHICLE;case 34:return j.HEAVY_VEHICLE}}(e)})),this.startPos=this.coordinates[0],this.endPos=this.coordinates[this.coordinates.length-1],this.presentTypes=[];for(var c=0;c<this.types.length;c++){var o=this.types[c];if(this.presentTypes.includes(o)||this.presentTypes.push(o),this.presentTypes.length===b.length)break}}return Object(L.a)(e,[{key:"getEstimated",value:function(){var e=this;return this.coordinates.filter((function(t,n){return e.estimated[n]}))}},{key:"getConfirmed",value:function(){var e=this;return this.coordinates.filter((function(t,n){return!e.estimated[n]}))}},{key:"toGround",value:function(e,t,n){return this.coordinates.map((function(a){return P(e,t,n,a)}))}},{key:"length",value:function(){return this.startPos.distanceTo(this.endPos)}},{key:"speed",value:function(){return this.speeds.reduce((function(e,t){return e+t}),0)/this.speeds.length}},{key:"pathString",value:function(e,t,n,a,i,r){for(var s=this.toGround(e,t,n),c=[],o=0;o<s.length-1;o++){for(var d="M ".concat(s[o][0]," ").concat(s[o][1]),u=m(this.types[o]);o<s.length-1&&this.types[o]===this.types[o+1];){o++;var h=this.estimated[o],j=Object(l.a)(s[o],2),b=j[0],f=j[1];if(d+="L ".concat(s[o][0]," ").concat(s[o][1]," "),i&&!h||r&&h){var g=h?3:6,p=Object(l.a)(s[o-1],2),O=p[0],x=p[1],v=Math.sqrt(Math.pow(O-b,2)+Math.pow(x-f,2)),y=0===v?1:v,k=[(f-x)/y,(O-b)/y],w=.707,T=k[0]*w-k[1]*w,C=k[0]*w+k[1]*w;d+="L ".concat(b+T*g," ").concat(f+C*g," L ").concat(b," ").concat(f," L ").concat(b-C*g," ").concat(f+T*g," L ").concat(b," ").concat(f," ")}}o+1!==s.length&&(d+="L ".concat(s[o+1][0]," ").concat(s[o+1][1]," ")),c.push([d,u])}return c}}],[{key:"idCompare",value:function(e,t){return e.id-t.id}},{key:"lengthCompare",value:function(e,t){return e.length()-t.length()}},{key:"speedCompare",value:function(e,t){return e.speed()-t.speed()}},{key:"typeCompare",value:function(e,t){return e.presentTypes.length!==t.presentTypes.length?e.presentTypes.length-t.presentTypes.length:e.presentTypes.reduce((function(e,t){return e+b.indexOf(t)}),0)-t.presentTypes.reduce((function(e,t){return e+b.indexOf(t)}),0)}}]),e}(),se=n(836),ce=n(802),oe=n(803),le=n(804),de=function(e){var t=e.tracks,n=e.selectedTracks,a=e.onTrackSelect;return Object(B.jsxs)(B.Fragment,{children:[0!==t.length&&Object(B.jsxs)(se.a,{children:[Object(B.jsx)(ce.a,{sx:{visibility:"hidden"},children:Object(B.jsx)(Q.a,{edge:"start",tabIndex:-1,disableRipple:!0})}),Object(B.jsx)(U.a,{fontWeight:500,sx:{width:"25%"},children:"Id"}),Object(B.jsx)(U.a,{fontWeight:500,sx:{width:"25%"},children:"Length"}),Object(B.jsx)(U.a,{fontWeight:500,sx:{width:"25%"},children:"Speed"}),Object(B.jsx)(U.a,{fontWeight:500,sx:{width:"25%"},children:"Type"})]}),t.map((function(e){return Object(B.jsxs)(oe.a,{onClick:function(t){return a(t,e)},children:[Object(B.jsx)(ce.a,{children:Object(B.jsx)(Q.a,{edge:"start",checked:n.has(e.id),tabIndex:-1,disableRipple:!0})}),Object(B.jsx)(le.a,{style:{width:"25%"},primary:e.id}),Object(B.jsx)(le.a,{style:{width:"25%"},primary:Math.round(1e4*(e.length()+Number.EPSILON))/1e4}),Object(B.jsx)(le.a,{style:{width:"25%"},primary:Math.round(1e4*(e.speed()+Number.EPSILON))/1e4}),Object(B.jsx)(le.a,{style:{width:"25%"},primary:e.presentTypes.reduce((function(e,t){return e+t+" "}),"")})]},e.id)}))]})},ue=function(e){var t=e.width,n=e.tracks,i=e.switchLeftLabel,r=e.switchRightLabel,s=e.selectedTracks,c=e.onSwitch,o=e.onTrackSelect,d=["Id","Length","Speed","Type"],u=Object(a.useState)(d[0]),h=Object(l.a)(u,2),j=h[0],b=h[1];return Object(B.jsx)("div",{style:{marginTop:10,width:t},children:Object(B.jsxs)($.a,{sx:{bgcolor:"background.paper",position:"relative",overflow:"auto",borderRadius:1,maxHeight:"100%"},dense:!0,subheader:Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:20,marginLeft:20,minHeight:60},children:[Object(B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(B.jsx)(U.a,{fontWeight:600,children:i}),Object(B.jsx)(ee.a,{onChange:c}),Object(B.jsx)(U.a,{fontWeight:600,children:r})]}),Object(B.jsxs)(J.a,{children:[Object(B.jsx)(te.a,{id:"demo-simple-select-label",children:Object(B.jsx)(U.a,{fontWeight:600,children:"Filter on"})}),Object(B.jsx)(ne.a,{sx:{height:40,width:100},labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,label:Object(B.jsx)(U.a,{fontWeight:600,children:"Filter on"}),onChange:function(e){var t;t=e.target.value,d.includes(t)&&b(e.target.value)},children:d.map((function(e,t){return Object(B.jsx)(ae.a,{value:e,children:e},t)}))})]})]}),component:"nav","aria-label":"tracks list",children:[Object(B.jsx)(ie.a,{sx:{borderBottomWidth:3}}),Object(B.jsx)(de,{tracks:function(e,t){return e.sort(function(e){switch(e){case"Id":default:return re.idCompare;case"Length":return re.lengthCompare;case"Type":return re.typeCompare;case"Speed":return re.speedCompare}}(t))}(n,j),selectedTracks:s,onTrackSelect:o})]})})},he=n(854),je=n(814),be=n(815),fe=n(203),me=n(81),ge=n(204),pe=n(165),Oe=n(213),xe=n(72),ve=function(e){var t=e.backgroundColor,n=e.children;return Object(B.jsx)("div",{className:"custom-tooltip",style:{zIndex:9999,borderRadius:5,backgroundColor:t,borderColor:"#FFFFFF",paddingLeft:10,paddingRight:10,border:"1px solid #FFF4F4"},children:n})},ye=function(e){for(var t=[],n=0;n<e;n++){var a=2*(e-n)/(e+1),i=(1-e+2*n)/(e+1);t.push([a,i])}return t},ke=function(e){var t=e.x,n=e.y,a=e.width,i=e.height,r=e.types;return void 0!==t&&void 0!==n&&void 0!==a&&void 0!==i?Object(B.jsxs)("svg",{width:a,height:i,x:t,y:n,children:[Object(B.jsx)("path",{d:"M 0 0 L 0 ".concat(i," L ").concat(a," ").concat(i," L ").concat(a," 0 z"),fill:m(r[0])}),1!==r.length?ye(r.length-1).map((function(e,t){var n=Object(l.a)(e,2),s=n[0],c=n[1];return Object(B.jsx)("path",{d:"M 0 ".concat(i*c," L ").concat(a*s," ").concat(i," L 0 ").concat(i," z"),fill:m(r[t+1])},t)})):null]}):null},we=function(e){return 0===e.length?"":e[0].startTime.toString()+e.length},Te={top:0,right:20,left:0,bottom:20},Ce=function(e){var t=e.tracks,n=e.height,i=e.binSize,r=e.valueLabel,s=function(e,t,n){return Object(a.useMemo)((function(){for(var a=e.reduce((function(e,t,a){console.log(a);var i=n(t);return[Math.min(e[0],i),Math.max(e[1],i)]}),[Number.MAX_VALUE,0]),i=Object(l.a)(a,2),r=i[0],s=(i[1]-r)/t,c=[],o=[],d=1;d<=t;d++){var u=r+(d-1)*s,h=r+d*s;c.push({min:u,max:h,ids:[]})}return e.forEach((function(e){var t=n(e),a=e.presentTypes.toString(),i=c.findIndex((function(e){return t>=e.min&&t<=e.max}));c[i].ids.push(e.id),Object.keys(c[i]).includes(a)?c[i][a]+=1:(c[i][a]=1,-1===o.findIndex((function(t){return n=t,a=e.presentTypes,n.length===a.length&&n.every((function(e){return a.includes(e)}));var n,a}))&&o.push(e.presentTypes))})),[c,o]}),[we(e),t])}(t,i,e.calcValue),c=Object(l.a)(s,2),o=c[0],d=c[1],u=Object(xe.a)().palette;return Object(B.jsx)(he.a,{width:"100%",height:n,children:Object(B.jsxs)(je.a,{data:o,margin:Te,children:[Object(B.jsx)(be.a,{}),Object(B.jsx)(fe.a,{dataKey:"min",type:"number",domain:[function(e){return e-3<0?0:e-3},function(e){return e+3}],fontFamily:"sans-serif",tickFormatter:function(e){return String(Math.round(100*e)/100)},children:Object(B.jsx)(me.a,{fontFamily:"sans-serif",value:"Number of samples",offset:-8,position:"insideBottom"})}),Object(B.jsx)(ge.a,{type:"number",fontFamily:"sans-serif"}),Object(B.jsx)(pe.a,{content:function(e){var t=e.payload;return e.active&&t&&t.length?Object(B.jsxs)(ve,{backgroundColor:u.background.default,children:[Object(B.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(B.jsxs)("small",{children:["".concat(r,": ").concat(Math.round(100*Number(t[0].payload.min))/100," - ").concat(Math.round(100*Number(t[0].payload.max))/100)," "]})}),t.map((function(e,t){return void 0!==e.dataKey?Object(B.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(B.jsx)("small",{children:"Types and entries: ".concat(e.dataKey,", ").concat(e.payload[e.dataKey])})},t+1):null}))]}):null}}),d.map((function(e,t){return Object(B.jsx)(Oe.a,{stackId:"a",dataKey:e.toString(),shape:Object(B.jsx)(ke,{types:e})},t)}))]})})},Se=function(e){var t=e.tracks,n=e.height,a=e.binSize;return Object(B.jsx)(Ce,{valueLabel:"Length",tracks:t,height:n,binSize:a,calcValue:function(e){return Math.round(100*e.length())/100}})},Le=n(271),Me=n.n(Le),Ne=(n(731),function(e){var t=e.collapsibleClassName,n=void 0===t?"collapsible-card":t,i=e.headerClassName,r=void 0===i?"collapsible-header":i,s=e.titleClassName,c=void 0===s?"title-text":s,o=e.contentClassName,d=void 0===o?"collapsible-content":o,u=e.contentContainerClassName,h=void 0===u?"collapsible-content-padding":u,j=e.isOpen,b=e.handleFilterOpening,f=e.children,m=e.header,g=Object(a.useState)(j?void 0:0),p=Object(l.a)(g,2),O=p[0],x=p[1],v=Object(xe.a)().palette,y=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(O&&j&&y.current){var e=new ResizeObserver((function(e){x(e[0].contentRect.height)}));return e.observe(y.current),function(){e.disconnect()}}}),[O,j]),Object(a.useEffect)((function(){var e;x(j?null===(e=y.current)||void 0===e?void 0:e.getBoundingClientRect().height:0)}),[j]),Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)("div",{className:n,style:{borderRadius:5,backgroundColor:v.background.default},children:[Object(B.jsxs)("div",{className:r,onClick:b,style:{borderRadius:5,backgroundColor:v.background.default},children:[Object(B.jsx)("div",{className:c,children:m}),j?Object(B.jsx)(Me.a,{sx:{transform:"rotate(180deg)",transitionDuration:0}}):Object(B.jsx)(Me.a,{})]}),Object(B.jsx)("div",{className:d,style:{height:O},children:Object(B.jsx)("div",{ref:y,children:Object(B.jsx)("div",{className:h,children:j?f:Object(B.jsx)(B.Fragment,{})})})})]})})}),Ie=function(e){var t=e.tracks,n=e.height,a=e.binSize;return Object(B.jsx)(Ce,{valueLabel:"Samples",tracks:t,height:n,binSize:a,calcValue:function(e){return e.coordinates.length}})},Fe=n(838);var Ee=function(e){var t=e.tracks,n=e.height,i=e.minHeight,r=e.maxHeight,s=e.isOpen,c=e.handleFilterOpening,o=Object(a.useState)(30),d=Object(l.a)(o,2),u=d[0],h=d[1],j=Object(a.useState)(30),b=Object(l.a)(j,2),f=b[0],m=b[1],g=function(e,t,n){return e<t?t:e>n?n:e}(n,i,r),O=function(e,t){var n=Number(e.target.value);isNaN(n)||t(n)};return Object(B.jsxs)(Ne,{isOpen:s,handleFilterOpening:c,header:"Show diagrams",children:[Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"top",marginBottom:10},children:[Object(B.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0,justifyContent:"space-between",alignContent:"top"},children:"Length histogram"}),Object(B.jsx)(Fe.a,{size:"small",variant:"standard",label:Object(B.jsx)(U.a,{fontWeight:600,children:"Number of bins"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},error:u<2,helperText:u<2?"Minimum bin size is ".concat(2):"",value:u,onChange:function(e){return O(e,h)}})]}),Object(B.jsx)(Se,{height:.5*g,binSize:u<2?2:u,tracks:t}),Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"top",marginBottom:10},children:[Object(B.jsx)("h5",{style:{fontFamily:"sans-serif",color:"#FFFFFF",marginTop:0},children:"Samples histogram"}),Object(B.jsx)(Fe.a,{size:"small",variant:"standard",label:Object(B.jsx)(U.a,{fontWeight:600,children:"Number of bins"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},value:f,error:f<2,helperText:f<2?"Minimum bin size is ".concat(2):"",onChange:function(e){return O(e,m)}})]}),Object(B.jsx)(Ie,{height:.5*g,tracks:t,binSize:f<2?2:f})]})},We=n(6),Re=n(817),He=n(424),ze=function(e){if(0===e.length)return[];var t=x()(e[0].timestamps[0]);return e.reduce((function(e,n){for(var a,i=[],r=n.speeds.length,s=0;s<r-1;s++){var c,o,l="".concat(n.id,":").concat(n.types[s]);if(i.push((c={},Object(We.a)(c,l,n.speeds[s]),Object(We.a)(c,"time",x()(n.timestamps[s]).diff(t)),Object(We.a)(c,"type",n.types[s]),c)),n.types[s]!==n.types[s+1])i.push((o={},Object(We.a)(o,l,n.speeds[s+1]),Object(We.a)(o,"time",x()(n.timestamps[s+1]).diff(t)),Object(We.a)(o,"type",n.types[s]),o))}var d="".concat(n.id,":").concat(n.types[r-1]);return i.push((a={},Object(We.a)(a,d,n.speeds[r-1]),Object(We.a)(a,"time",x()(n.timestamps[r-1]).diff(t)),Object(We.a)(a,"type",n.types[r-1]),a)),e=e.concat(i)}),[])},De=function(e){return e.reduce((function(e,t,n){for(var a,i=x()(t.startTime),r=[],s=t.speeds.length,c=0;c<s-1;c++){var o,l,d="".concat(t.id,":").concat(t.types[c]);if(r.push((o={},Object(We.a)(o,d,t.speeds[c]),Object(We.a)(o,"time",x()(t.timestamps[c]).diff(i)),Object(We.a)(o,"type",t.types[c]),o)),t.types[c]!==t.types[c+1])r.push((l={},Object(We.a)(l,d,t.speeds[c+1]),Object(We.a)(l,"time",x()(t.timestamps[c+1]).diff(i)),Object(We.a)(l,"type",t.types[c]),l))}var u="".concat(t.id,":").concat(t.types[s-1]);return r.push((a={},Object(We.a)(a,u,t.speeds[s-1]),Object(We.a)(a,"time",x()(t.timestamps[s-1]).diff(i)),Object(We.a)(a,"type",t.types[s-1]),a)),e=e.concat(r)}),[])},_e=function(e){return e.reduce((function(e,t){for(var n,a=[],i=t.speeds.length,r=0;r<i-1;r++){var s,c,o="".concat(t.id,":").concat(t.types[r]);if(a.push((s={},Object(We.a)(s,o,t.speeds[r]),Object(We.a)(s,"time",t.startPos.distanceTo(t.coordinates[r])),Object(We.a)(s,"type",t.types[r]),s)),t.types[r]!==t.types[r+1])a.push((c={},Object(We.a)(c,o,t.speeds[r+1]),Object(We.a)(c,"time",t.startPos.distanceTo(t.coordinates[r+1])),Object(We.a)(c,"type",t.types[r]),c))}var l="".concat(t.id,":").concat(t.types[i-1]);return a.push((n={},Object(We.a)(n,l,t.speeds[i-1]),Object(We.a)(n,"time",t.startPos.distanceTo(t.coordinates[i-1])),Object(We.a)(n,"type",t.types[i-1]),n)),e=e.concat(a)}),[])},Pe=function(e){var t=e.tracks,n=e.height,i=e.plotOn,r=function(e,t){return Object(a.useMemo)((function(){switch(console.log("Recalculating val"),t){case"Absolute time":return ze(e);case"Relative time":return De(e);case"Distance from start":return _e(e)}}),[we(e),t])}(t,i),s=Object(xe.a)().palette;return Object(B.jsx)(he.a,{width:"100%",height:n,children:Object(B.jsxs)(Re.a,{data:r,children:[Object(B.jsx)(be.a,{}),Object(B.jsx)(fe.a,{dataKey:"time",type:"number",domain:["dataMin","dataMax"],tickFormatter:function(e){return function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?n.format("HH:mm:ss"):n.add(e,"milliseconds").format("HH:mm:ss"):String(e);case"Relative time":return String(e/1e3)+" s";case"Distance from start":return String(e)+" m"}}(e,i,0!==t.length?t[0].startTime:void 0)}}),Object(B.jsx)(ge.a,{children:Object(B.jsx)(me.a,{fontFamily:"sans-serif",value:"km/h",position:"insideLeft",angle:-90})}),Object(B.jsx)(pe.a,{content:function(e){var n=e.active,a=e.payload,r=e.label;return n&&a&&a.length?Object(B.jsxs)(ve,{backgroundColor:s.background.default,children:[Object(B.jsx)("p",{className:"nbr-label",style:{fontFamily:"sans-serif"},children:Object(B.jsx)("small",{children:"Id: ".concat(Object.keys(a[0].payload)[0].split(":")[0])})}),Object(B.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:Object(B.jsx)("small",{children:"Speed: ".concat("number"===typeof a[0].value?Math.round(100*a[0].value)/100:a[0].value)})}),Object(B.jsx)("p",{className:"lengt-label",style:{fontFamily:"sans-serif"},children:Object(B.jsx)("small",{children:Ve(r,i,0!==t.length?t[0].startTime:void 0)})})]}):null}}),t.map((function(e,t){return e.presentTypes.map((function(t){return Object(B.jsx)(He.a,{type:"monotone",dataKey:"".concat(e.id,":").concat(t),stroke:m(t),dot:!1},"".concat(e.id,":").concat(t))}))}))]})})},Ve=function(e,t,n){switch(t){case"Absolute time":return x.a.isDayjs(n)?0===e?"Time: "+n.format("HH:mm:ss"):"Time: "+n.add(e,"milliseconds").format("HH:mm:ss"):"Time: "+String(e);case"Relative time":return"Time: "+String(Math.round(100*e)/1e5)+" s";case"Distance from start":return"Distance: "+String(Math.round(100*e)/100)+" m"}},Be=["Relative time","Absolute time","Distance from start"],Ae=function(e){var t=e.tracks,n=e.height,i=e.isOpen,r=e.handleFilterOpening,s=Object(a.useState)(Be[0]),c=Object(l.a)(s,2),o=c[0],d=c[1];return Object(B.jsx)("div",{style:{height:n,width:"100%",marginTop:10,marginLeft:10},children:Object(B.jsxs)(Ne,{isOpen:i,handleFilterOpening:r,header:"Speed",children:[Object(B.jsxs)(J.a,{sx:{marginBottom:2},children:[Object(B.jsx)(te.a,{id:"demo-simple-select-label",children:Object(B.jsx)(U.a,{fontWeight:600,children:"Plot on"})}),Object(B.jsx)(ne.a,{sx:{height:40,width:200},labelId:"demo-simple-select-label",id:"demo-simple-select",value:o,label:Object(B.jsx)(U.a,{fontWeight:600,children:"Plot on"}),onChange:function(e){var t;t=e.target.value,Be.includes(t)&&d(e.target.value)},children:Be.map((function(e,t){return Object(B.jsx)(ae.a,{value:e,children:e},t)}))})]}),Object(B.jsx)(Pe,{tracks:t,height:n,plotOn:o})]})})},Ke=function(e){var t=e.label,n=e.plotterWidth,i=e.image,r=e.imageWidth,s=e.imageHeight,c=e.tracks,d=e.ground,u=Object(a.useState)(Math.round(100*(n/r+Number.EPSILON))/100*.66),j=Object(l.a)(u,2),b=j[0],f=j[1],m=s*Math.round(100*(n/r+Number.EPSILON))/100*.7,g=Object(a.useState)({markMeasurements:!1,markEstimated:!1,onlyConfirmed:!1,trackId:!1,showLines:!1,filterSelected:!1}),p=Object(l.a)(g,2),O=p[0],x=p[1],v=Object(a.useState)(new Set),y=Object(l.a)(v,2),k=y[0],T=y[1],C=Object(a.useState)(!0),S=Object(l.a)(C,2),L=S[0],M=S[1],N=Object(a.useState)(!1),I=Object(l.a)(N,2),F=I[0],E=I[1],W=Object(a.useState)(!1),R=Object(l.a)(W,2),H=R[0],z=R[1],D=function(){return c.filter((function(e){return O.filterSelected===k.has(e.id)}))};return Object(B.jsxs)("div",{style:{width:n},children:[Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:10},children:[Object(B.jsxs)(h.a,{onClick:function(){return M((function(e){return!e}))},sx:{marginRight:1},variant:"text",children:["Version ",t]}),L&&Object(B.jsx)(G.a,{value:b,"aria-label":"Default",valueLabelDisplay:"auto",onChange:function(e,t){"number"===typeof t&&f(t)},min:0,max:4,step:.01,color:"primary",className:"slider",style:{margin:0,width:"66%",maxWidth:1060}})]}),L&&Object(B.jsx)(Z,{filters:O,onMarkMeasurements:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{markMeasurements:e.target.checked})}))},onMarkEstimated:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{markEstimated:e.target.checked})}))},onMarkOnlyConfirmed:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{onlyConfirmed:e.target.checked})}))},onMarkTrackId:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{trackId:e.target.checked})}))}})]}),Object(B.jsxs)("div",{style:{overflow:"hidden",height:s*b,minHeight:.7*m,maxHeight:m,display:"flex",flexDirection:"row"},children:[Object(B.jsx)("div",{style:{width:"66.6%",overflow:"hidden"},children:Object(B.jsx)(Y.a,{children:Object(B.jsx)("div",{className:"image-container",style:{width:r*b,height:s*b,backgroundImage:"url(".concat(i,")")},children:Object(B.jsx)(A,{tracks:D(),WIDTH:r,HEIGHT:s,scale:b,showId:O.trackId,ground:d,filters:O})})})}),Object(B.jsxs)("div",{style:{width:"33.3%",marginLeft:10},children:[Object(B.jsxs)(U.a,{fontWeight:600,sx:{marginBottom:1},children:["Number of tracks: ",c.length]}),0!==c.length?Object(B.jsx)(Ee,{isOpen:F,handleFilterOpening:function(){E((function(e){return!e}))},height:s*b-220,minHeight:.7*m-220,maxHeight:m-220,tracks:D()}):null]})]}),Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:.7*m+150},children:[Object(B.jsx)(ue,{width:.5*n,tracks:Object(w.a)(c),switchLeftLabel:"Hide",switchRightLabel:"Show",selectedTracks:k,onSwitch:function(e){x((function(t){return Object(o.a)(Object(o.a)({},t),{},{filterSelected:e.target.checked})}))},onTrackSelect:function(e,t){k.has(t.id)?T((function(e){return e.delete(t.id),new Set(e)})):T((function(e){return e.add(t.id),new Set(e)}))}}),Object(B.jsx)(Ae,{isOpen:H,handleFilterOpening:function(){z((function(e){return!e}))},tracks:D(),height:.7*m})]})]})},Ye=function(e){var t=e.fromTime,n=e.toTime,a=e.showType,i=e.showVersions,r=e.filterLength,s=Object(c.useRenderData)(),o=s.args.images,l=s.args.shapes,d=s.args.grounds,u=s.args.names,h=d.map((function(e){return{pos:Object(k.a)(N,Object(w.a)(e[0])),height:e[1],width:e[2]}})),j=function(e,t,n){return e.isAfter(t)&&e.isBefore(n)},b=s.args.tracks.map((function(e){return e.map((function(e){return Object(k.a)(re,Object(w.a)(e))})).filter((function(e){return function(e,t,n,a,i){if(!j(e.startTime,t,n)&&!j(e.endTime,t,n))return!1;var r,s=Object(y.a)(e.presentTypes);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(!a.includes(c))return!1}}catch(o){s.e(o)}finally{s.f()}return!i.filter||!(e.length()<i.minLength||e.length()>i.maxLength)}(e,t,n,a,r)}))})),f=i.length<=1?1:i.length%3===0?3:i.length%2===0?2:3;return Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[b.map((function(e,t){return-1===i.indexOf(u[t])?null:Object(B.jsx)("div",{style:{margin:5},children:Object(B.jsx)(Ke,{image:o[t],plotterWidth:(window.innerWidth-20*f)/f,imageHeight:l[t][0],imageWidth:l[t][1],tracks:e,label:u[t],ground:h[t]})},t)})),Object(B.jsx)("div",{style:{height:1e4}})]})},Ge=n(425),Ue=n(824),Je=n(825),qe=n(818),Xe=function(e){var t=e.data,n=e.changeDate,a=e.changeTime,i=e.changeIntervalMin,r=e.changeIntervalSec;return Object(B.jsxs)(Ge.a,{dateAdapter:qe.a,children:[Object(B.jsx)(Ue.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"Date"}),format:"YYYY-MM-DD",value:t.date,onChange:n,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(B.jsx)(Je.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"From time"}),value:t.fromTime,onChange:a,ampm:!1,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2,width:g}}),Object(B.jsx)(Fe.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"Interval in minutes"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,marginRight:2},value:t.intervalMin,onChange:i}),Object(B.jsx)(Fe.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"Interval in seconds"}),id:"outlined-start-adornment",sx:{width:p,backgroundColor:"background.default",borderRadius:1,margin:0},value:t.intervalSec,onChange:r})]})},Qe=function(e){var t=e.data,n=e.checkFilterBox,a=e.changeMinLength,i=e.changeMaxLength;return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{control:Object(B.jsx)(Q.a,{checked:t.filterLength.filter,onChange:n}),label:Object(B.jsx)(U.a,{fontWeight:600,children:"Filter length"}),style:{margin:0,marginTop:10,fontWeight:500}}),t.filterLength.filter&&Object(B.jsxs)("div",{style:{marginTop:10},children:[Object(B.jsx)(Fe.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"Min length"}),id:"outlined-start-adornment",sx:{m:1,width:p,backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.minLength,onChange:a}),Object(B.jsx)(Fe.a,{label:Object(B.jsx)(U.a,{fontWeight:600,children:"Max length"}),id:"outlined-start-adornment",sx:{m:1,width:p,backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.maxLength,onChange:i})]})]})},Ze=n(840),$e=function(e){var t=e.title,n=e.value,a=e.labels,i=e.checked,r=e.handleChange,s={PaperProps:{style:{maxHeight:224,width:250}}};return Object(B.jsxs)(J.a,{sx:{m:1,width:g,margin:0,marginLeft:2},children:[Object(B.jsx)(te.a,{id:"demo-multiple-name-label",children:Object(B.jsx)(U.a,{fontWeight:600,children:t})}),Object(B.jsx)(ne.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:n,onChange:r,input:Object(B.jsx)(Ze.a,{label:t}),renderValue:function(e){return e.join(", ")},MenuProps:s,sx:{backgroundColor:"background.default"},children:a.map((function(e,t){return Object(B.jsxs)(ae.a,{value:e,children:[Object(B.jsx)(Q.a,{checked:i(e)}),Object(B.jsx)(le.a,{primary:e})]},t)}))})]})},et=function(){var e=Object(c.useRenderData)(),t=e.args.names,n=e.args.data,i=x()(n.date),r={date:i,fromTime:i,intervalMin:n.min,intervalSec:n.sec,showType:n.types,showVersions:n.versions,filterLength:n.filter},s=Object(a.useState)(r),j=Object(l.a)(s,2),m=j[0],g=j[1],p=e.theme,O=Object(d.a)({palette:{primary:{main:null===p||void 0===p?void 0:p.primaryColor},common:{black:null===p||void 0===p?void 0:p.base},text:{primary:null===p||void 0===p?void 0:p.textColor,secondary:null===p||void 0===p?void 0:p.textColor},action:{active:"#fff"},background:{default:null===p||void 0===p?void 0:p.secondaryBackgroundColor,paper:null===p||void 0===p?void 0:p.secondaryBackgroundColor}}});Object(a.useEffect)((function(){m.date.isValid()&&v.Streamlit.setComponentValue({date:m.date.format(),min:m.intervalMin,sec:m.intervalSec,versions:m.showVersions,types:m.showType,filter:m.filterLength})}),[m.date]);var y=function(e){x.a.isDayjs(e)&&g((function(t){return t.fromTime.hour()!==e.hour()&&(t.date=e),t.fromTime=e,Object(o.a)({},t)}))};return Object(B.jsx)(u.a,{theme:O,children:Object(B.jsxs)("div",{style:{marginTop:30},children:[Object(B.jsx)(Xe,{data:m,changeDate:function(e){x.a.isDayjs(e)&&g((function(t){return t.date=e,Object(o.a)({},t)}))},changeTime:y,changeIntervalMin:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalMin=t,Object(o.a)({},e)}))},changeIntervalSec:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.intervalSec=t,Object(o.a)({},e)}))}}),Object(B.jsx)($e,{title:"Show versions",value:m.showVersions,labels:t,checked:function(e){return-1!==m.showVersions.indexOf(e)},handleChange:function(e){var n=e.target.value;g((function(e){return e.showVersions="string"===typeof n?n.split(""):n.sort((function(e,n){return t.indexOf(e)-t.indexOf(n)})),Object(o.a)({},e)}))}}),Object(B.jsx)($e,{title:"Show types",value:m.showType,labels:b,checked:function(e){return f(e)&&-1!==m.showType.indexOf(e)},handleChange:function(e){var t=e.target.value;g((function(e){return e.showType="string"===typeof t?function(e){return f(e)?[e]:[]}(t):t,Object(o.a)({},e)}))}}),Object(B.jsx)(Qe,{data:m,checkFilterBox:function(e){g((function(t){return t.filterLength.filter=e.target.checked,Object(o.a)({},t)}))},changeMinLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.minLength=t,Object(o.a)({},e)}))},changeMaxLength:function(e){var t=Number(e.target.value);isNaN(t)||g((function(e){return e.filterLength.maxLength=t,Object(o.a)({},e)}))}}),Object(B.jsxs)("div",{style:{margin:0,marginTop:10},children:[Object(B.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){y(m.fromTime.subtract(m.intervalMin,"minutes").subtract(m.intervalSec,"seconds"))},children:"<"}),Object(B.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){y(m.fromTime.add(m.intervalMin,"minutes").add(m.intervalSec,"seconds"))},children:">"})]}),Object(B.jsx)(Ye,{fromTime:m.fromTime,toTime:m.fromTime.add(m.intervalMin,"minutes").add(m.intervalSec,"seconds"),showType:m.showType,showVersions:m.showVersions,filterLength:m.filterLength})]})})};console.warn=function(){},s.a.render(Object(B.jsx)(i.a.StrictMode,{children:Object(B.jsx)(c.StreamlitProvider,{children:Object(B.jsx)(et,{})})}),document.getElementById("root"))}},[[733,1,2]]]);
//# sourceMappingURL=main.704aae7b.chunk.js.map