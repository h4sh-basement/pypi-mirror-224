<!DOCTYPE html>
<html>

<head>
    <title>hive脚本执行控制台</title>
    <script src="/static/js/jquery-2.1.4.min.js"></script>
</head>
<style>
pre{
    height: 500px;
    width: 600px;
    list-style-type: none;
    overflow:auto;
}
</style>
<body>

<form action="" id="form">
    <input id="input1" type="text" size="40px" list="path"/>
    <datalist id="path">
        {% for path in path_list %}
        <option>{{ path }}</option>
        {% end %}
    </datalist>
    <input id="execute" type="button" value="执行"/>
</form>

<pre id="textDiv">
</pre>


<script type="text/javascript">
//    $("#textDiv").scrollTo('100%')
    var ws = new WebSocket("ws://127.0.0.1:19999/ws");
    ws.onopen = function () {
        ws.send("Hello, world");
    };
    ws.onmessage = function (evt) {
//        document.getElementById('textDiv').innerHTML = evt.data;
        $("#textDiv").append(evt.data+'<br>');
        $("#textDiv").scrollTop($("#textDiv")[0].scrollHeight);

    };

    $("#input1").change(function(){
        var cmd = document.getElementById("input1").value;
        $.post("/",{cmd:cmd},function(result){
            $('#path').html(result)
        });
    });

    $("#execute").click(function(e){
        var cmd = document.getElementById("input1").value;
        $.post("/execute",{cmd:cmd},function(result){
            $("#textDiv").append(result);
            $("#textDiv").scrollTop($("#textDiv")[0].scrollHeight);
        });
    });
</script>
</body>
</html>
