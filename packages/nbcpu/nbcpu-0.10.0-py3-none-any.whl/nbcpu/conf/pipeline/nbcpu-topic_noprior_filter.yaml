defaults:
  - nbcpu-datasets

use_task_as_initial_object: false
steps:
  - uses: load_dataframes
    with:
      data_files: ${__project_workspace_path__:}/nbcpu-topic_noprior/model/outputs/LDA_model(1)_k(20)-doc_topic_dists.parquet
      verbose: true
  - uses: dataframe_print_head_and_tail
    with:
      verbose: true
    verbose: true
  - uses: dataframe_eval_columns
    with:
      expressions:
        topic_irrelevant: "topic3 + topic4 + topic5 + topic11 + topic14 + topic16"
      verbose: true
  - uses: filter_and_sample_data
    with:
      queries:
        - "topic_irrelevant < 0.6"
      output_dir: datasets/processed/topic_noprior_filtered
      train_filename: train.parquet
      discard_filename: discard.parquet
      verbose: true
